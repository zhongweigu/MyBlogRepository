<% if (theme.dplayer.enable) { %>
<!-- dplayer 视频 start -->
<script type="text/javascript" src="https://<%= theme.jsdelivr_mirror || 'cdn.jsdelivr.net' %>/npm/hls.js"></script>
<script type="text/javascript" src="https://<%= theme.jsdelivr_mirror || 'cdn.jsdelivr.net' %>/npm/dplayer@1.27.1/dist/DPlayer.min.js"></script>
<script type="text/javascript">
  const dplayer = document.querySelectorAll(".dplayer-box");
  dplayer && initDPlayer(dplayer);
  function initDPlayer(els) {
    let elsArr = Array.from(els);
    elsArr.forEach(el => {
      let url = el.dataset.url;
      let pic = el.dataset.pic;
      let subtitle = el.dataset.subtitle;

      let options = {
        container: el,
        video: { url: url, pic: pic },
        theme: "<%= theme.dplayer.theme %>",
        autoplay: <%= theme.dplayer.autoplay %>,
        loop: <%= theme.dplayer.loop %>,
        mutex: <%= theme.dplayer.mutex %>,
      }

      if (subtitle) {
        options.subtitle = {
          url: el.dataset.subtitle,
        }
      }
      new DPlayer(options);
    });
  }
</script>
<!-- dplayer 视频 end -->
<% } %>